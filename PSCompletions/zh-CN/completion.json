{
    "$schema": "http://json-schema.org/draft-07/schema",
    "description": "PSCompletions 模块补全数据文件的 JSON Schema",
    "type": "object",
    "anyOf": [
        {
            "required": [
                "root"
            ]
        },
        {
            "required": [
                "options"
            ]
        }
    ],
    "$defs": {
        "root_item": {
            "type": "object",
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "description": "命令名称",
                    "type": "string",
                    "minLength": 1
                },
                "alias": {
                    "description": "命令别名",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1
                },
                "symbol": {
                    "description": "类型:字符串或数组\n符号,一般情况下它只应该返回 SpaceTab",
                    "oneOf": [
                        {
                            "type": "string",
                            "enum": [
                                "SpaceTab"
                            ]
                        },
                        {
                            "type": "array",
                            "examples": [
                                [
                                    "{{",
                                    "if($true){ 'SpaceTab' }",
                                    "}}"
                                ]
                            ],
                            "items": {
                                "type": "string"
                            },
                            "minItems": 1
                        }
                    ]
                },
                "tip": {
                    "description": "补全提示信息",
                    "examples": [
                        "",
                        []
                    ],
                    "oneOf": [
                        {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "minItems": 1
                        },
                        {
                            "type": "string"
                        }
                    ]
                },
                "next": {
                    "description": "下一个命令补全, 这用来定义输入命令后按下 Tab 键后可以获取到的补全",
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/root_item"
                    },
                    "minItems": 1
                },
                "options": {
                    "description": "可用的选项类补全",
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/options_item"
                    },
                    "minItems": 1
                }
            },
            "additionalProperties": false
        },
        "options_item": {
            "type": "object",
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "description": "命令名称",
                    "type": "string",
                    "minLength": 1
                },
                "alias": {
                    "description": "命令别名",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1
                },
                "symbol": {
                    "description": "类型:字符串或数组\n符号,在 options 中, 默认已经添加了一个 OptionTab",
                    "oneOf": [
                        {
                            "type": "string",
                            "enum": [
                                "WriteSpaceTab"
                            ]
                        },
                        {
                            "type": "array",
                            "examples": [
                                [],
                                [
                                    "WriteSpaceTab",
                                    "SpaceTab"
                                ],
                                [
                                    "{{",
                                    "if($true){'WriteSpaceTab'}",
                                    "}}"
                                ]
                            ],
                            "items": {
                                "type": "string",
                                "examples": [
                                    "WriteSpaceTab",
                                    "SpaceTab"
                                ]
                            },
                            "minItems": 1
                        }
                    ]
                },
                "tip": {
                    "description": "补全提示信息",
                    "examples": [
                        "",
                        []
                    ],
                    "oneOf": [
                        {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "minItems": 1
                        },
                        {
                            "type": "string"
                        }
                    ]
                },
                "next": {
                    "description": "下一个命令补全, 这用来定义输入命令后按下 Tab 键后可以获取到的补全\n如果添加了 next , 会给当前命令的 symbol 自动添加一个 WriteSpaceTab",
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/root_item"
                    },
                    "minItems": 1
                }
            },
            "additionalProperties": false
        },
        "common_options_item": {
            "type": "object",
            "required": [
                "name"
            ],
            "properties": {
                "name": {
                    "description": "命令名称",
                    "type": "string",
                    "minLength": 1
                },
                "alias": {
                    "description": "命令别名",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1
                },
                "symbol": {
                    "description": "类型:字符串或数组\n符号,在 common_options 中, 默认已经添加了一个 OptionTab\n无法添加 SpaceTab, 因为 common_options 不支持定义 next",
                    "oneOf": [
                        {
                            "type": "string",
                            "enum": [
                                "WriteSpaceTab"
                            ]
                        },
                        {
                            "type": "array",
                            "examples": [
                                [],
                                [
                                    "{{",
                                    "if($true){'WriteSpaceTab'}",
                                    "}}"
                                ]
                            ],
                            "items": {
                                "type": "string",
                                "examples": [
                                    "WriteSpaceTab"
                                ]
                            },
                            "minItems": 1
                        }
                    ]
                },
                "tip": {
                    "description": "补全提示信息",
                    "examples": [
                        "",
                        []
                    ],
                    "oneOf": [
                        {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "minItems": 1
                        },
                        {
                            "type": "string"
                        }
                    ]
                }
            },
            "additionalProperties": false
        }
    },
    "properties": {
        "root": {
            "description": "命令的根节点",
            "type": "array",
            "items": {
                "$ref": "#/$defs/root_item"
            },
            "minItems": 1
        },
        "options": {
            "description": "根命令的选项",
            "type": "array",
            "items": {
                "$ref": "#/$defs/options_item"
            },
            "minItems": 1
        },
        "common_options": {
            "description": "一些通用的选项, 这些选项会在任何情况下都出现",
            "type": "array",
            "items": {
                "$ref": "#/$defs/common_options_item"
            },
            "minItems": 1
        },
        "info": {
            "description": "一些补全的信息\n这些信息可以在此 json 文件任何地方使用 {{ $info.xxx }} 进行访问",
            "type": "object",
            "minProperties": 1
        },
        "config": {
            "description": "定义一些特别的配置项",
            "type": "array",
            "items": {
                "type": "object",
                "required": [
                    "name",
                    "value",
                    "tip"
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "配置项的名称",
                        "minLength": 1
                    },
                    "value": {
                        "description": "配置项的初始值"
                    },
                    "values": {
                        "description": "配置项的可选值\n这里填写的值会在 completion 命令补全中显示",
                        "type": "array",
                        "minItems": 1
                    },
                    "tip": {
                        "description": "配置项的提示信息",
                        "oneOf": [
                            {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            {
                                "type": "string"
                            }
                        ]
                    }
                }
            }
        }
    },
    "additionalProperties": false
}
